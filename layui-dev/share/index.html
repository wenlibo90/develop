<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>柠檬分享</title>
    <meta name="viewport" content="width=750px, user-scalable=no"/>
    <link rel="stylesheet" href="../css/lemon.css">
</head>
<body>
<div style="margin: 0 auto;height: 0;padding: 0;overflow: hidden">
    <img src="" alt="" id="shareImg">
</div>
    <div class="lemon car">
        <div class="top">
            <div class="t-top download">
                <img class="l" src="../images/share/logo.png" alt=""><span class="l">柠檬竞价</span><span class="r"> 下载APP</span>
            </div>
            <div class="t-btm slide">
                <ul class="slide-img">
                    <li><img src="../images/share/car1.png"/></li>
                </ul>
             <!-- <div class="txtBox">
                  <ul class="txt">
                      <li>左前45度</li>
                      <li>左前135度</li>
                  </ul>
              </div>
              -->
                <div class="tab-hd">
                    <span class="pageState l"><span>1</span><i>/</i>1</span>
                </div>
            </div>
        </div>
        <div class="btm">
           <div class="carDetail">
               <div class="detailTop">
                   <p class="carTit">
                       2011款 路虎揽胜 1.3T <span class="code">（编号C172）</span>
                   </p>
                   <p class="level">
                       <span class="l">北京 | 2016年 | 7.9万KM | 国四 </span>
                       <span class="r">质检等级 <span class="leveCode">A级-</span>
                   </span>
                   </p>
                   <p class="time">
                       <em></em>开拍时间15:30
                   </p>
                   <p class="firstPrice">
                       起拍价 <span class="color-y"><span class="big">5.4万</span>起</span>
                   </p>
                   <p class="server">成交服务费1500元 </p>
               </div>
               <div class="imMsg">
                   <p class="tit"><span>重要信息<i></i></span></p>
                   <ul class="listShow carBaseMsgBox">
                       <li>
                           <span class="name">迁往何处</span>
                           <span class="cont moveToWhere">均可</span>
                       </li>
                       <li>
                           <span class="name">买方承担</span>
                           <span class="cont buyerBear">过户费  运费  提档费</span>
                       </li>
                       <li>
                           <span class="name">卖方承担</span>
                           <span class="cont sellerBear">无</span>
                       </li>
                       <li>
                           <span class="name">备注说明</span>
                           <span class="cont remark">北京地区过户，交易完成立即过户</span>
                       </li>
                   </ul>
               </div>
               <div class="imMsg">
                   <p class="tit"><span>基本信息<i></i></span></p>
                   <ul class="listShow carDetailMsgBox">
                       <li>
                           <span class="name">车辆信息</span>
                           <span class="cont autoInfoName">2011款 路虎222</span>
                       </li>
                       <li>
                           <span class="name">车辆VIN</span>
                           <span class="cont vin">过户费 运费 提档费用</span>
                       </li>
                       <li>
                           <span class="name">表显里程</span>
                           <span class="cont mileage">无</span>
                       </li>
                       <li>
                           <span class="name">排量</span>
                           <span class="cont engineCapacity">无</span>
                       </li>
                       <li>
                           <span class="name">排放标准</span>
                           <span class="cont environment">无</span>
                       </li>
                       <li>
                           <span class="name">出场日期</span>
                           <span class="cont manufactureDate">无</span>
                       </li>
                       <li>
                           <span class="name">初次上牌</span>
                           <span class="cont beginRegisterDate">无</span>
                       </li>
                       <li>
                           <span class="name">车辆所在地</span>
                           <span class="cont vehicleAttributionProvince">无</span>
                       </li>
                       <li>
                           <span class="name">车辆归属地</span>
                           <span class="cont vehicleAttributionCity">无</span>
                       </li>

                       <li>
                           <span class="name">车牌号</span>
                           <span class="cont licenseNumber">无</span>
                       </li>
                       <li>
                           <span class="name">车辆性质</span>
                           <span class="cont carNature">无</span>
                       </li>
                       <li>
                           <span class="name">使用性质</span>
                           <span class="cont useNature">无</span>
                       </li>
                       <li>
                           <span class="name">新车参考价</span>
                           <span class="cont originalPrice">无(仅供参考)</span>
                       </li>
                       <li>
                           <span class="name">驱动方式</span>
                           <span class="cont vehicleDriver">无</span>
                       </li>
                       <li>
                           <span class="name">变速箱方式</span>
                           <span class="cont transmission">无</span>
                       </li>
                       <li>
                           <span class="name">车身颜色</span>
                           <span class="cont color">无</span>
                       </li>
                       <li>
                           <span class="name">是否改装</span>
                           <span class="cont isModification">无</span>
                       </li>
                       <li>
                           <span class="name">标准配置</span>
                           <span class="cont configs">无</span>
                       </li>
                       <li>
                           <span class="name">加装配置</span>
                           <span class="cont configs1">无</span>
                       </li>
                   </ul>
               </div>
           </div>
            <img src="../images/share/logoBtom.png" alt="柠檬竞拍" class="logoBtom">
            <div class="fix">
                <a href="javascript:void(0)" class="download">我要竞拍</a>
            </div>
        </div>
    </div>
<div class="msg"></div>
<div class="load">
    <img src="image/load_top.png" alt="在微信中打开" class="loadTop r">
    <img src="image/load_btm.png" class="loadBtm">
</div>
</body>
<script src="http://static.yuntongauto.com/js/jquery.min.js"></script>
<script src="js/share.js"></script>
<script>
  /*  jQuery(".slide").slide({ mainCell:".slide-img", effect:"left", delayTime:400,easing:"easeOutCubic" ,autoPlay:true,
        startFun:function(i){
            jQuery(".txtBox .txt li").eq(i).animate({"bottom":0}).siblings().animate({"bottom":-36})}
        })*/
    function init() {
        if(getUrlParam().carId){
            getBaseMsg(getUrlParam().carId)
            getDetailMsg(getUrlParam().carId)
        }else{
            $('.msg').html('没有车辆id').fadeIn().delay(1500).fadeOut()
        }
    }
   init();

    function getBaseMsg(carId) {
        $.ajax({
            url:basePath+'/boss/carAuto/selectByCarId',
            type:'post',
            beforeSend:beforeSend,
            async:false,
            dataType:'json',
            data:JSON.stringify({
                carId:carId
            }),
            error : function(data) {
                alert('服务器走丢了，请联系管理员')
            },
            success : function(data){
                console.log(data)
                if(data.success){
                   BaseMsgView(data.data)
                }else{
                    $('.msg').html(data.resultMsg).fadeIn().delay(1500).fadeOut()
                }
            }
        });
    }
    function getDetailMsg(carId) {
        $.ajax({
            url:basePath+'/boss/carAuto/selectDetailByCarId',
            type:'post',
            beforeSend:beforeSend,
            async:false,
            dataType:'json',
            data:JSON.stringify({
                carId:carId
            }),
            error : function(data) {
                alert('服务器走丢了')
            },
            success : function(data){
                console.log(data)
                if(data.success){
                    DetailView(data.data)
                }else{
                    $('.msg').html(data.resultMsg).fadeIn().delay(1500).fadeOut()
                }
            }
        });
    }
    function DetailView(data) {
        $('.autoInfoName').html(data.autoInfoName);
        $('.vin').html(data.vin);
        $('.mileage').html(data.mileage/1000+'km');
        $('.engineCapacity').html(data.engineCapacity+data.engineCapacityUnit);
        $('.environment').html(data.environment);
        $('.manufactureDate').html(timeFormat(data.manufactureDate).y+'年'+timeFormat(data.manufactureDate).m+'月'+timeFormat(data.manufactureDate).d+'日');
        $('.beginRegisterDate').html(timeFormat(data.beginRegisterDate).y+'年'+timeFormat(data.beginRegisterDate).m+'月'+timeFormat(data.beginRegisterDate).d+'日');
        $('.vehicleAttributionProvince').html(data.vehicleAttributionProvince);
        $('.vehicleAttributionCity').html(data.vehicleAttributionCity);
        $('.licenseNumber').html(data.licenseNumber);
        $('.carNature').html(data.carNature);
        $('.useNature').html(data.useNature);
        $('.originalPrice').html(data.originalPrice);
        $('.vehicleDriver').html(data.vehicleDriver);
        $('.transmission').html(data.transmission);
        $('.isModification').html(data.isModification);
        $('.color').html(data.color);
        var str='',str1='';
        $.each(data.configs,function(i,v){
            if(v.confOption==1){
                str+=v.confOptionCn+v.confTitleName+',';
            }else if(v.confOption==3){
                str1+=v.confOptionCn+v.confTitleName+',';
            }
        });
        $('.configs').html(str.slice(0,-1));
        $('.configs1').html(str1.slice(0,-1))
        $.each($('.carDetailMsgBox li span:last-child'),function(i,v){
            isNull($(v))
        })
    }
    function isNull(myele) {
        if(myele.html()==''){
            myele.parents('li').remove();
        }
    }
    function BaseMsgView(data) {
        if(data.carAutoPhotos.length<1){
            $('#shareImg').attr('src','../images/share/car1.png');
        }else{
            $('.slide-img').html('')
            var arr=data.carAutoPhotos;
            $.each(arr,function(i,v){
                $('.slide-img').append('<li><img src="'+v.photoUrl+'" height="484" width="750" /></li>')
            })
            jQuery(".slide").slide({ mainCell:".slide-img", effect:"left", delayTime:400,easing:"easeOutCubic" ,autoPlay:true,
                startFun:function(i){
                    //jQuery(".txtBox .txt li").eq(i).animate({"bottom":0}).siblings().animate({"bottom":-36})
            }
            })
        }
        var startingPrice='';
        if(data.startingPrice){
            startingPrice=(data.startingPrice)/10000;
        }else{
            startingPrice='*'
        }
        var servicePrice='';
        if(data.servicePrice){
            servicePrice=(data.servicePrice);
        }else{
            servicePrice='*'
        }
        var reportColligationRanks=''
        if(data.reportColligationRanks){
            reportColligationRanks='<span class="r">质检等级 <span class="leveCode">'+data.reportColligationRanks+data.reportServicingRanks+'</span> ';
        }else{
            reportColligationRanks=''
        }
        var vehicleAttributionCity=''
        if(data.vehicleAttributionCity){
            vehicleAttributionCity=' <span class="l">'+data.vehicleAttributionCity+' | ';
        }else{
            vehicleAttributionCity=''
        }
        var environment=''
        if(data.environment){
            environment=data.environment;
        }else{
            environment=''
        }

        $('.detailTop').html('<p class="carTit">'+data.autoInfoName+'<span class="code">（编号'+data.carAutoNo+'）</span> </p> ' +
            '<p class="level">'+vehicleAttributionCity+(timeFormat(data.beginRegisterDate)).y+'年 | '+data.mileage/1000+'km | '+environment+' </span> ' +
            reportColligationRanks+'</p>' +
            '<p class="time"><em></em>开拍时间：'+timeFormat(data.auctionStartTime).h+':'+timeFormat(data.auctionStartTime).mm+' </p> ' +
            '<p class="firstPrice">起拍价 <span class="color-y"><span class="big">'+startingPrice+'万</span>起</span> </p> ' +
            '<p class="server">成交服务费'+servicePrice+'元 </p>')
        $('.remark').html(data.remark);
        $('.sellerBear').html(data.sellerBear);
        $('.buyerBear').html(data.buyerBear);
        $('.moveToWhere').html(data.moveToWhere)
        $.each($('.carBaseMsgBox li span:last-child'),function(i,v){
            isNull($(v))
        })
      /*  var $body = $('body');
        document.title = data.autoInfoName;
        var $iframe = $('<iframe src="http://www.ningmengcar.com/ht/share/index.html"></iframe>');
        $iframe.on('load',function() {
            setTimeout(function() {
                $iframe.off('load').remove();
            }, 0);
        }).appendTo($body);*/
    }

</script>
</html>